# è®¢é˜…ç®¡ç†ç³»ç»Ÿ - å®‰è£…éƒ¨ç½²æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

è®¢é˜…ç®¡ç†ç³»ç»Ÿæ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„è®¢é˜…æœåŠ¡ç®¡ç†å¹³å°ï¼Œå¸®åŠ©ç”¨æˆ·è½»æ¾ç®¡ç†å’Œè·Ÿè¸ªå„ç§è®¢é˜…æœåŠ¡çš„è´¹ç”¨å’Œç»­è´¹æƒ…å†µã€‚

### ğŸŒŸ ä¸»è¦åŠŸèƒ½
- **æ™ºèƒ½è®¢é˜…ç®¡ç†** - å®Œæ•´çš„è®¢é˜…ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œæ”¯æŒè‡ªåŠ¨/æ‰‹åŠ¨ç»­è´¹
- **å¤šå¸ç§æ”¯æŒ** - æ”¯æŒ8ç§ä¸»è¦è´§å¸ï¼Œå®æ—¶æ±‡ç‡è‡ªåŠ¨æ›´æ–°
- **è´¹ç”¨åˆ†ææŠ¥å‘Š** - å¼ºå¤§çš„æ•°æ®åˆ†æå’Œå¯è§†åŒ–å›¾è¡¨åŠŸèƒ½
- **å“åº”å¼è®¾è®¡** - å®Œç¾é€‚é…æ¡Œé¢å’Œç§»åŠ¨ç«¯
- **æœ¬åœ°ä¼˜å…ˆ** - åŸºäºSQLiteçš„æœ¬åœ°æ•°æ®å­˜å‚¨ï¼Œä¿æŠ¤ç”¨æˆ·éšç§
- **ğŸ” è®¸å¯è¯ç³»ç»Ÿ** - æ”¯æŒå…è´¹ç‰ˆã€ä¸“ä¸šç‰ˆã€è£èª‰ç»ˆç”Ÿç‰ˆ

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç³»ç»Ÿè¦æ±‚
- **Node.js**: 20+ ç‰ˆæœ¬
- **å†…å­˜**: è‡³å°‘ 512MB
- **å­˜å‚¨**: è‡³å°‘ 100MB å¯ç”¨ç©ºé—´
- **ç½‘ç»œ**: éœ€è¦äº’è”ç½‘è¿æ¥ï¼ˆç”¨äºæ±‡ç‡æ›´æ–°å’Œè®¸å¯è¯éªŒè¯ï¼‰

### å®‰è£…æ–¹å¼

#### æ–¹å¼ä¸€ï¼šDocker run éƒ¨ç½²ï¼ˆæ¨èï¼‰

æ•°æ®ç›®å½•å‡†å¤‡

```bash
# åˆ›å»ºæ•°æ®ç›®å½•å¹¶è®¾ç½®æƒé™
mkdir -p ${PWD}/subscription-manager/data
chown -R 1001:1001 ${PWD}/subscription-manager/data
chmod 755 ${PWD}/subscription-manager/data
```

```bash
docker stop subscription-manager
docker rm subscription-manager

docker run -d \
  --name subscription-manager \
  --restart unless-stopped \
  --user 0 \
  -p 3001:3001 \
  -v ${PWD}/subscription-manager/data:/app/data \
  -e API_KEY="your_secret_api_key_here" \
  -e TIANAPI_KEY="your_tianapi_key_here" \
  -e PORT="3001" \
  -e BASE_CURRENCY="CNY" \
  -e NODE_ENV="production" \
  -e VITE_API_URL="/api" \
  -e DATABASE_PATH="/app/data/database.sqlite" \
  zhoujie218/subscription-manager:latest
```



#### æ–¹å¼äºŒï¼šDocker compose éƒ¨ç½²ï¼ˆæ¨èï¼‰

1. **å…‹éš†é¡¹ç›®**
```bash
git clone https://github.com/vbskycn/Subscription-Management.git
cd Subscription-Management
```

2. **é…ç½®ç¯å¢ƒå˜é‡**
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘ç¯å¢ƒå˜é‡
nano .env
```

3. **å¯åŠ¨æœåŠ¡**
```bash
# ä½¿ç”¨ Docker Compose å¯åŠ¨
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps
```

4. **è®¿é—®åº”ç”¨**
æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š`http://localhost:3001`



#### æ–¹å¼ä¸‰ï¼šæœ¬åœ°å®‰è£…

1. **å…‹éš†é¡¹ç›®**
```bash
git clone https://github.com/vbskycn/Subscription-Management.git
cd Subscription-Management
```

2. **å®‰è£…ä¾èµ–**
```bash
# å®‰è£…å‰ç«¯ä¾èµ–
npm install

# å®‰è£…åç«¯ä¾èµ–
cd server
npm install
cd ..
```

3. **åˆå§‹åŒ–æ•°æ®åº“**
```bash
cd server
npm run db:init
cd ..
```

4. **å¯åŠ¨æœåŠ¡**
```bash
# å¯åŠ¨åç«¯æœåŠ¡ï¼ˆç»ˆç«¯1ï¼‰
cd server
npm start

# å¯åŠ¨å‰ç«¯æœåŠ¡ï¼ˆç»ˆç«¯2ï¼‰
npm run dev
```

5. **è®¿é—®åº”ç”¨**
æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š`http://localhost:5173`

## âš™ï¸ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡é…ç½®

#### åŸºç¡€é…ç½®
```bash
# .env
# APIå¯†é’¥ï¼ˆå¿…éœ€ï¼‰
API_KEY=your-api-key-here

# ç«¯å£é…ç½®
PORT=3001

# åŸºç¡€è´§å¸
BASE_CURRENCY=CNY

# æ±‡ç‡APIå¯†é’¥ï¼ˆå¯é€‰ï¼Œç”¨äºè‡ªåŠ¨æ±‡ç‡æ›´æ–°ï¼‰
TIANAPI_KEY=your-tianapi-key

# æ•°æ®åº“è·¯å¾„
DATABASE_PATH=./db/database.sqlite
```

#### è®¸å¯è¯ç³»ç»Ÿé…ç½®ï¼ˆå¯é€‰ï¼‰
```bash
# è®¸å¯è¯æœåŠ¡å™¨åœ°å€ï¼ˆé»˜è®¤ä½¿ç”¨å†…ç½®ä»£ç†ï¼‰
LICENSE_SERVER_URL=https://your-license-server.com

# è°ƒè¯•æ¨¡å¼ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
VITE_DEBUG=true
```

### è®¸å¯è¯ç³»ç»Ÿé…ç½®

#### ç‰ˆæœ¬ç±»å‹
- **å…è´¹ç‰ˆ** - é™åˆ¶7ä¸ªè®¢é˜…ï¼ŒåŸºç¡€åŠŸèƒ½
- **ä¸“ä¸šç‰ˆ** - æ— é™åˆ¶è®¢é˜…ï¼Œ1å¹´æœ‰æ•ˆæœŸ
- **è£èª‰ç»ˆç”Ÿç‰ˆ** - æ— é™åˆ¶è®¢é˜…ï¼Œæ°¸ä¹…æœ‰æ•ˆ

#### æ¿€æ´»è®¸å¯è¯
1. è®¿é—®è®¾ç½®é¡µé¢
2. ç‚¹å‡»"è®¸å¯è¯ç®¡ç†"
3. è¾“å…¥è®¸å¯è¯å¯†é’¥
4. ç‚¹å‡»"éªŒè¯è®¸å¯è¯"

#### ä¿®æ”¹è®¢é˜…æ•°é‡é™åˆ¶
```typescript
// ä¿®æ”¹ src/config/license.ts
FREE_TIER_LIMITS: {
  maxSubscriptions: 10,  // ä¿®æ”¹ä¸ºæ–°çš„é™åˆ¶æ•°é‡
  canExport: true,
  canImport: true
}
```

## ğŸ”§ éƒ¨ç½²é…ç½®

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

#### Docker ç”Ÿäº§éƒ¨ç½²
```bash
# æ„å»ºç”Ÿäº§é•œåƒ
docker build -t subscription-manager .

# è¿è¡Œå®¹å™¨
docker run -d \
  --name subscription-manager \
  -p 3001:3001 \
  -v subscription-data:/app/data \
  -e NODE_ENV=production \
  -e API_KEY=your-production-api-key \
  subscription-manager
```

#### ä¼ ç»ŸæœåŠ¡å™¨éƒ¨ç½²
```bash
# æ„å»ºå‰ç«¯
npm run build

# å¯åŠ¨åç«¯æœåŠ¡
cd server
NODE_ENV=production npm start
```

### åŸŸåé…ç½®

#### Nginx é…ç½®ç¤ºä¾‹
```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    location / {
        proxy_pass http://localhost:3001;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

### SSL è¯ä¹¦é…ç½®
```bash
# ä½¿ç”¨ Let's Encrypt
sudo certbot --nginx -d your-domain.com
```

## ğŸ“± ä½¿ç”¨æŒ‡å—

### åŸºæœ¬æ“ä½œ

#### æ·»åŠ è®¢é˜…
1. ç‚¹å‡»"æ·»åŠ è®¢é˜…"æŒ‰é’®
2. å¡«å†™è®¢é˜…ä¿¡æ¯ï¼ˆåç§°ã€é‡‘é¢ã€è®¡è´¹å‘¨æœŸç­‰ï¼‰
3. é€‰æ‹©åˆ†ç±»å’Œæ”¯ä»˜æ–¹å¼
4. ç‚¹å‡»"ä¿å­˜"

#### ç®¡ç†è®¢é˜…
- **ç¼–è¾‘**ï¼šç‚¹å‡»è®¢é˜…å¡ç‰‡ä¸Šçš„ç¼–è¾‘æŒ‰é’®
- **åˆ é™¤**ï¼šç‚¹å‡»è®¢é˜…å¡ç‰‡ä¸Šçš„åˆ é™¤æŒ‰é’®
- **çŠ¶æ€ç®¡ç†**ï¼šå¯ä»¥è®¾ç½®è®¢é˜…ä¸ºæ´»è·ƒã€è¯•ç”¨æˆ–å·²å–æ¶ˆ

#### æŸ¥çœ‹æŠ¥å‘Š
- **ä»ªè¡¨æ¿**ï¼šæŸ¥çœ‹æ€»ä½“è´¹ç”¨æ¦‚è§ˆ
- **è´¹ç”¨æŠ¥å‘Š**ï¼šæŸ¥çœ‹è¯¦ç»†çš„è´¹ç”¨åˆ†æå›¾è¡¨
- **æ”¯ä»˜å†å²**ï¼šæŸ¥çœ‹æ‰€æœ‰æ”¯ä»˜è®°å½•

### æ•°æ®ç®¡ç†

#### å¯¼å…¥æ•°æ®
1. ç‚¹å‡»"å¯¼å…¥"æŒ‰é’®
2. é€‰æ‹© CSV æˆ– JSON æ–‡ä»¶
3. ç¡®è®¤å¯¼å…¥æ•°æ®
4. æŸ¥çœ‹å¯¼å…¥ç»“æœ

#### å¯¼å‡ºæ•°æ®
1. ç‚¹å‡»"å¯¼å‡º"æŒ‰é’®
2. é€‰æ‹©å¯¼å‡ºæ ¼å¼ï¼ˆCSV æˆ– JSONï¼‰
3. ä¸‹è½½å¯¼å‡ºæ–‡ä»¶

#### å¤‡ä»½æ•°æ®
```bash
# å¤‡ä»½æ•°æ®åº“æ–‡ä»¶
cp ./server/db/database.sqlite ./backup/database-$(date +%Y%m%d).sqlite
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æœåŠ¡æ— æ³•å¯åŠ¨
```bash
# æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
lsof -i :3001

# æ£€æŸ¥æ—¥å¿—
docker logs subscription-manager
```

#### 2. æ•°æ®åº“é”™è¯¯
```bash
# é‡æ–°åˆå§‹åŒ–æ•°æ®åº“
cd server
npm run db:reset
```

#### 3. è®¸å¯è¯éªŒè¯å¤±è´¥
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- ç¡®è®¤è®¸å¯è¯å¯†é’¥æ­£ç¡®
- æŸ¥çœ‹è®¸å¯è¯æœåŠ¡å™¨çŠ¶æ€

#### 4. æ±‡ç‡æ›´æ–°å¤±è´¥
- æ£€æŸ¥ TIANAPI_KEY æ˜¯å¦æ­£ç¡®
- ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸
- æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—

### æ—¥å¿—æŸ¥çœ‹

#### Docker æ—¥å¿—
```bash
# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs subscription-manager

# å®æ—¶æŸ¥çœ‹æ—¥å¿—
docker logs -f subscription-manager
```

#### æœ¬åœ°å®‰è£…æ—¥å¿—
```bash
# æŸ¥çœ‹åç«¯æ—¥å¿—
cd server
tail -f logs/app.log
```

### æ€§èƒ½ä¼˜åŒ–

#### æ•°æ®åº“ä¼˜åŒ–
```sql
-- åˆ›å»ºç´¢å¼•
CREATE INDEX idx_subscriptions_status ON subscriptions(status);
CREATE INDEX idx_payment_history_date ON payment_history(payment_date);
```

#### å†…å­˜ä¼˜åŒ–
```bash
# å¢åŠ  Node.js å†…å­˜é™åˆ¶
NODE_OPTIONS="--max-old-space-size=2048" npm start
```

## ğŸ”— ç›¸å…³èµ„æº

- **é¡¹ç›®ä»“åº“**: [GitHub](https://github.com/vbskycn/Subscription-Management)
- **è®¸å¯è¯è´­ä¹°**: [å‘å¡ç½‘ç«™](https://ifdian.net/a/izbds)
- **æŠ€æœ¯æ”¯æŒ**: [GitHub Issues](https://github.com/vbskycn/Subscription-Management/issues)

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è·å–æ”¯æŒï¼š
- æŸ¥çœ‹æœ¬æ–‡æ¡£çš„æ•…éšœæ’é™¤éƒ¨åˆ†
- æäº¤ [GitHub Issue](https://github.com/vbskycn/Subscription-Management/issues)
- è”ç³»å¼€å‘è€…è·å–æŠ€æœ¯æ”¯æŒ 